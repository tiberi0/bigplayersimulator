<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart']});
      google.charts.setOnLoadCallback(drawChart);
      var myVar = setInterval(alertFunc, 1000);
      var candleTick = 0;
      var candles = [['0',15,15,15,15]]
      var ultimPreco = 1500;
      var tick = 0;

        function stopTrade(){
            clearInterval(myVar);
        }

        function alertFunc() {
            
            //ultimPreco = ultimPreco-5;
            var randOk = Math.floor(Math.random() * 3)
            console.log(randOk)
            var price = ultimPreco;
            if(randOk==0)
                price = price-1;//randOk
            if(randOk==1)
                price = price+1;//+randOk-5
            
            ultimPreco = price;
            price = price/100;
            
            if(candles[candleTick][1]> price)
                candles[candleTick][1] = price
            
            candles[candleTick][2] = price

            if(candles[candleTick][4]< price)
                candles[candleTick][4] = price
            
            tick++;
            if(tick>=20){  
                tick = 0;              
                candleTick++; 
                candles.push([(candleTick*20).toString(),price,price,price,price])
            }

            drawChart();
        }

        function drawChart() {
                var data = google.visualization.arrayToDataTable(candles, true);

                var options = {
                legend:'none'
                };

                var chart = new google.visualization.CandlestickChart(document.getElementById('chart_div'));

                chart.draw(data, options);
            }

    
    </script>
  </head>
  <body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
    
    <input type="button" onclick="stopTrade()" value="STOP"/>
  </body>
</html>